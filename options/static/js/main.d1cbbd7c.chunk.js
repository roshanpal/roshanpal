(this.webpackJsonpoptions=this.webpackJsonpoptions||[]).push([[0],{36:function(e,t,n){},39:function(e,t,n){},64:function(e,t,n){"use strict";n.r(t);var i=n(0),c=n.n(i),r=n(23),s=n.n(r),a=(n(36),n(29)),o=n(7),l=n(13),d=n.n(l),j=n(24),h=n(8),p=n(25),u=n(26),x=n(31),b=n(30),O=(n(38),n(39),n(66)),f=n(67),y=n(28),P=n(69),g=n(68),m=n(70),k=n(27),v=n.n(k),C=n(9),S=n.n(C),L=n(1),E=function(e){Object(x.a)(n,e);var t=Object(b.a)(n);function n(){var e;Object(p.a)(this,n);for(var i=arguments.length,c=new Array(i),r=0;r<i;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={expiries:[],options:[],nifty:0,timestamp:null,expiry:null,hedges:[],quantity:75,positions:[],optionType:"CE"},e.database=null,e.handleChange=function(t){e.setState(Object(h.a)({},t.target.name,t.target.value)),"strike"===t.target.name&&e.calculateHedge(parseInt(t.target.value))},e.dumpToLocalStorage=function(){localStorage.setItem("positions",JSON.stringify(e.state.positions))},e.setupBeforeUnloadListener=function(){window.addEventListener("beforeunload",(function(t){return t.preventDefault(),e.dumpToLocalStorage()}))},e}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.fetchOptionChain(),this.setupBeforeUnloadListener(),localStorage.getItem("positions")&&this.setState({positions:JSON.parse(localStorage.getItem("positions"))})}},{key:"fetchOptionChain",value:function(){var e=Object(j.a)(d.a.mark((function e(){var t,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.a.get("https://www.nseindia.com/api/option-chain-indices?symbol=NIFTY");case 3:t=e.sent,n=t.data.records,this.setState({expiries:S.a.take(n.expiryDates,5),nifty:n.underlyingValue,timestamp:n.timestamp}),this.setState({options:this.processData(n.data)}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),alert("Request Failed");case 12:this.updatePositions();case 13:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"updatePositions",value:function(){var e=this.state,t=e.positions,n=e.options;t=t.map((function(e){if("open"!==e.state)return e;var t=n[e.expiryDate].find((function(t){return t[e.optionType].strikePrice==e.strikePrice}));return Object(o.a)(Object(o.a)({},e),{},{ltp:t[e.optionType].lastPrice})})),this.setState({positions:t})}},{key:"processData",value:function(e){var t=this.state,n=t.expiries,i=t.nifty,c={};return e.forEach((function(e){n.includes(e.expiryDate)&&(c[e.expiryDate]?S.a.inRange(e.strikePrice,i-700,i+700)&&c[e.expiryDate].push(e):c[e.expiryDate]=[])})),c}},{key:"calculateHedge",value:function(e){var t=this.state,n=t.options,i=t.expiry,c=t.quantity,r=t.optionType,s=S.a.mapKeys(n[i],"strikePrice");console.log(s);var a=s[e][r].lastPrice,o="CE"===r?[this.calculatePnL(e,e+50,s,a,c,50),this.calculatePnL(e,e+100,s,a,c,100),this.calculatePnL(e,e+150,s,a,c,150),this.calculatePnL(e,e+200,s,a,c,200)]:[this.calculatePnL(e,e-50,s,a,c,50),this.calculatePnL(e,e-100,s,a,c,100),this.calculatePnL(e,e-150,s,a,c,150),this.calculatePnL(e,e-200,s,a,c,200)];this.setState({hedges:o})}},{key:"calculatePnL",value:function(e,t,n,i,c,r){var s=this.state.optionType,a=i*c-n[t][s].lastPrice*c,o=r*c-c*(i-n[t][s].lastPrice);return{strikePrice:e,hedgePrice:t,maxProfit:a,maxLoss:o,riskReward:o/a}}},{key:"placeOrder",value:function(e,t,n){var i=this.state.positions,c="long"===e?75:-75;this.setState({positions:[].concat(Object(a.a)(i),[Object(o.a)(Object(o.a)({},t[n]),{},{state:"open",optionType:n,quantity:c})])})}},{key:"render",value:function(){var e=this,t=this.state,n=t.expiries,i=t.options,c=t.nifty,r=t.expiry,s=(t.strike,t.hedges),a=t.positions;return Object(L.jsx)("div",{className:"App",style:{background:"#999"},children:Object(L.jsx)(O.a,{style:{maxWidth:"99%"},children:Object(L.jsxs)(f.a,{children:[Object(L.jsxs)(y.a,{xs:7,children:[Object(L.jsx)(P.a,{children:Object(L.jsxs)(P.a.Group,{controlId:"exampleForm.SelectCustom",children:[Object(L.jsx)(P.a.Label,{children:"Select Expiry"}),Object(L.jsxs)(P.a.Control,{as:"select",name:"expiry",onChange:this.handleChange,custom:!0,children:[Object(L.jsx)("option",{children:"Select"}),n&&n.map((function(e){return Object(L.jsx)("option",{value:e,children:e},e)}))]})]})}),Object(L.jsxs)(g.a,{striped:!0,bordered:!0,hover:!0,variant:"dark",children:[Object(L.jsx)("thead",{children:Object(L.jsxs)("tr",{children:[Object(L.jsx)("th",{children:"Strike"}),Object(L.jsx)("th",{children:"Expiry"}),Object(L.jsx)("th",{children:"CE"}),Object(L.jsx)("th",{}),Object(L.jsx)("th",{children:"PE"}),Object(L.jsx)("th",{})]})}),Object(L.jsx)("tbody",{children:r&&i[r].map((function(t){return Object(L.jsxs)("tr",{children:[Object(L.jsx)("td",{children:t.strikePrice}),Object(L.jsx)("td",{children:t.expiryDate}),Object(L.jsx)("td",{style:c<t.CE.strikePrice?{background:"grey"}:{},children:t.CE.lastPrice}),Object(L.jsxs)("td",{children:[Object(L.jsx)(m.a,{variant:"success",onClick:function(){return e.placeOrder("long",t,"CE")},children:"+"}),"\xa0",Object(L.jsx)(m.a,{variant:"danger",onClick:function(){return e.placeOrder("short",t,"CE")},children:"-"})]}),Object(L.jsx)("td",{style:c>t.CE.strikePrice?{background:"grey"}:{},children:t.PE.lastPrice}),Object(L.jsxs)("td",{children:[Object(L.jsx)(m.a,{variant:"success",onClick:function(){return e.placeOrder("long",t,"PE")},children:"+"}),"\xa0",Object(L.jsx)(m.a,{variant:"danger",onClick:function(){return e.placeOrder("short",t,"PE")},children:"-"})]})]},t.strikePrice)}))})]})]}),Object(L.jsxs)(y.a,{children:[Object(L.jsxs)(f.a,{children:[Object(L.jsx)(y.a,{xs:8,children:Object(L.jsx)(P.a,{children:Object(L.jsxs)(P.a.Group,{controlId:"exampleForm.SelectCustom",children:[Object(L.jsx)(P.a.Label,{children:"Select Strike Price"}),Object(L.jsxs)(P.a.Control,{as:"select",name:"strike",onChange:this.handleChange,custom:!0,children:[Object(L.jsx)("option",{children:"Select"}),r&&i[r].map((function(e){return Object(L.jsx)("option",{value:e.strikePrice,children:e.strikePrice},e.strikePrice)}))]})]})})}),Object(L.jsx)(y.a,{children:Object(L.jsx)(P.a,{children:Object(L.jsxs)(P.a.Group,{controlId:"exampleForm.SelectCustom",children:[Object(L.jsx)(P.a.Label,{children:"Select Option Type"}),Object(L.jsxs)(P.a.Control,{as:"select",name:"optionType",onChange:this.handleChange,custom:!0,children:[Object(L.jsx)("option",{value:"CE",children:"CE"}),Object(L.jsx)("option",{value:"PE",children:"PE"})]})]})})})]}),Object(L.jsxs)(g.a,{striped:!0,bordered:!0,hover:!0,variant:"dark",children:[Object(L.jsx)("thead",{children:Object(L.jsxs)("tr",{children:[Object(L.jsx)("th",{children:"Strike"}),Object(L.jsx)("th",{children:"Hedge"}),Object(L.jsx)("th",{children:"Max Profit"}),Object(L.jsx)("th",{children:"Max Loss"}),Object(L.jsx)("th",{children:"Risk Reward Ratio"})]})}),Object(L.jsx)("tbody",{children:s&&s.map((function(e){return Object(L.jsxs)("tr",{children:[Object(L.jsx)("td",{children:e.strikePrice}),Object(L.jsx)("td",{children:e.hedgePrice}),Object(L.jsx)("td",{children:e.maxProfit.toFixed(2)}),Object(L.jsx)("td",{children:e.maxLoss.toFixed(2)}),Object(L.jsxs)("td",{children:["1 : ",e.riskReward.toFixed(2)]})]},e.hedgePrice)}))})]}),Object(L.jsxs)(g.a,{striped:!0,bordered:!0,hover:!0,variant:"dark",children:[Object(L.jsx)("thead",{children:Object(L.jsxs)("tr",{children:[Object(L.jsx)("th",{children:"Option"}),Object(L.jsx)("th",{children:"Net Price"}),Object(L.jsx)("th",{children:"LTP"}),Object(L.jsx)("th",{children:"P&L"})]})}),Object(L.jsx)("tbody",{children:a&&a.map((function(e){return Object(L.jsxs)("tr",{children:[Object(L.jsx)("td",{children:"".concat(e.expiryDate," ").concat(e.strikePrice)}),Object(L.jsx)("td",{children:e.lastPrice}),Object(L.jsx)("td",{children:e.ltp}),Object(L.jsx)("td",{children:parseInt(e.lastPrice)-parseInt(e.ltp)})]},e.identifier)}))})]})]})]})})})}}]),n}(c.a.Component),T=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,71)).then((function(t){var n=t.getCLS,i=t.getFID,c=t.getFCP,r=t.getLCP,s=t.getTTFB;n(e),i(e),c(e),r(e),s(e)}))};s.a.render(Object(L.jsx)(c.a.StrictMode,{children:Object(L.jsx)(E,{})}),document.getElementById("root")),T()}},[[64,1,2]]]);
//# sourceMappingURL=main.d1cbbd7c.chunk.js.map